<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>停车入库 - 小游戏</title>
  <link rel="stylesheet" href="./style.css" />
  <link rel="stylesheet" href="./mobile.css" />
</head>
<body>
  <!-- 顶部信息栏 -->
  <div class="top-hud">
    <div class="game-info">
      <div class="hud-header">
        <div class="hud-icon">
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="24" height="24">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="#fff"/>
          </svg>
        </div>
        <div class="title">停车入库</div>
      </div>
      <div class="info">
        <div id="level">关卡: 1</div>
        <div id="status">准备开始</div>
      </div>
    </div>
    
    <div class="controls-info">
      <div class="controls">
        方向键/WASD 控制，空格刹车<br>
        成功按 N/回车 继续，失败按 R 重试
      </div>
    </div>
    
    <div class="audio-controls">
      <button id="music-toggle" class="music-btn">🎵 音乐</button>
      <input type="range" id="volume-slider" min="0" max="100" value="50" class="volume-slider">
      <button id="sound-toggle" class="music-btn">🔊 音效</button>
      <button id="test-sound" class="music-btn">🔊 测试</button>
    </div>
  </div>

  <!-- 移动端设置抽屉 -->
  <div class="mobile-settings-drawer" id="mobile-settings-drawer">
    <div class="drawer-overlay" id="drawer-overlay"></div>
    <div class="drawer-content">
      <div class="drawer-header">
        <h3>设置</h3>
        <button class="drawer-close" id="drawer-close">×</button>
      </div>
      <div class="drawer-body">
        <div class="setting-group">
          <label>音量</label>
          <input type="range" id="mobile-volume-slider" min="0" max="100" value="50" class="volume-slider">
        </div>
        <div class="setting-group">
          <button id="mobile-music-toggle" class="setting-btn">🎵 音乐</button>
          <button id="mobile-sound-toggle" class="setting-btn">🔊 音效</button>
          <button id="mobile-test-sound" class="setting-btn">🔊 测试</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 桌面端游戏容器 -->
  <div class="game-container">
    <canvas id="game" width="1280" height="720"></canvas>
    
    <!-- 桌面端方向盘 -->
    <div id="fpv" class="steering-wrap desktop-only" style="--size: 240px;">
      <div class="wheel" id="steering-wheel-display" role="slider" tabindex="0" aria-valuemin="-450" aria-valuemax="450" aria-valuenow="0" aria-label="Steering wheel control">
        <!-- Outer bezel with tick marks -->
        <div class="bezel">
          <div class="ticks"></div>
          <div class="tick-strong"></div>
        </div>

        <!-- Rim (grip) -->
        <div class="rim">
          <div class="grip"></div>
          <div class="grip"></div>
          <div class="grip"></div>
        </div>

        <!-- Spokes -->
        <div class="spokes">
          <span class="spoke"></span>
          <span class="spoke"></span>
          <span class="spoke"></span>
        </div>

        <!-- Center hub -->
        <div class="hub">
          <div class="hub-core"></div>
        </div>

        <!-- Top marker (fixed in wheel coords) -->
        <div class="marker"></div>
      </div>

      <!-- Value readout (UI) -->
      <div class="readout">
        <div class="value" id="steering-angle-display">0°</div>
        <div class="hint">方向盘角度</div>
      </div>
      
      <!-- Car status display -->
      <div class="car-status">
        <div class="status-item">
          <div class="status-label">速度</div>
          <div class="status-value" id="speed-display">0.0 km/h</div>
        </div>
        <div class="status-item">
          <div class="status-label">档位</div>
          <div class="status-value" id="gear-display">D</div>
        </div>
        <div class="status-item">
          <div class="status-label">状态</div>
          <div class="status-value" id="direction-display">静止</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 移动端布局容器 -->
  <div class="mobile-layout">
    <!-- 移动端Header -->
    <header class="mobile-header">
      <div class="mobile-game-info">
        <div class="mobile-title">停车入库</div>
        <div class="mobile-level" id="mobile-level">关卡: 1</div>
        <div class="mobile-status" id="mobile-status">准备开始</div>
      </div>
      <button class="mobile-settings-btn" id="mobile-settings-btn" aria-label="设置">
        <svg viewBox="0 0 24 24" width="20" height="20">
          <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" fill="currentColor"/>
        </svg>
      </button>
    </header>

    <!-- 游戏画布区域 -->
    <div class="game-stage">
      <canvas id="game-mobile" width="1280" height="720"></canvas>
    </div>

    <!-- 移动端底部操作区 -->
    <div class="mobile-bottom-bar">
      <!-- 状态卡片 -->
      <div class="mobile-status-card">
        <div class="status-item">
          <div class="status-label">速度</div>
          <div class="status-value" id="mobile-speed-display">0.0 km/h</div>
        </div>
        <div class="status-item">
          <div class="status-label">档位</div>
          <div class="status-value" id="mobile-gear-display">D</div>
        </div>
        <div class="status-item">
          <div class="status-label">状态</div>
          <div class="status-value" id="mobile-direction-display">静止</div>
        </div>
      </div>

      <!-- 操作控制区 -->
      <div class="mobile-controls">
        <!-- 方向盘 -->
        <div class="mobile-steering">
          <div class="steering-wheel" id="mobile-steering-wheel" aria-label="方向盘">
            <div class="steering-center"></div>
          </div>
        </div>
        
        <!-- 踏板控制 -->
        <div class="mobile-pedals">
          <div class="pedal-row">
            <button class="mobile-pedal gas-pedal" id="mobile-gas-pedal" aria-label="油门">油门</button>
            <button class="mobile-pedal brake-pedal" id="mobile-brake-pedal" aria-label="刹车">刹车</button>
          </div>
          <div class="pedal-row">
            <button class="mobile-pedal reverse-pedal" id="mobile-reverse-pedal" aria-label="倒车">倒车</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="overlay" class="overlay">
    <div class="card">
      <div class="title" id="ov-title">结算</div>
      <div class="desc" id="ov-desc"></div>
      <div class="row"><span class="label">用时</span><span class="value" id="ov-time">0.0s</span></div>
      <div class="row"><span class="label">碰撞次数</span><span class="value" id="ov-hit">0</span></div>
      <div class="row"><span class="label">分数</span><span class="value" id="ov-score">0</span></div>
      <div class="row"><span class="label">评级</span><span class="value" id="ov-grade">-</span></div>
      <div class="actions">
        <button class="btn" id="btn-retry">重试 (R)</button>
        <button class="btn primary" id="btn-next">继续 (Enter/N)</button>
      </div>
    </div>
  </div>
  <script src="./game.js"></script>
</body>
</html>

